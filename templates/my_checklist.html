[[extend 'layout.html']]

<style>
[v-cloak] {
     display: none;
}
</style>

<div class="section" id="app" v-cloak>
  [[if not globals().get('user'):]]
  <div class="notification is-warning">
    <p>You must be logged in to access this feature. <a href="/Bird-Watcher/auth/login">Login</a></p>
  </div>
  [[else:]]
  <div>
    <h1 class="title"><i class="fa-solid fa-list"></i> My Birdwatching Checklists</h1>

    <div v-if="checklists.length === 0">
      <p>No checklists found.</p>
    </div>

    <div v-for="(checklist, index) in checklists" :key="index" class="box">
      <h2 class="subtitle">Checklist ID: {{ checklist.id }}</h2>
      <div v-for="(count, species) in checklist.sightings" :key="species">
        <p>{{ species }}: {{ count }} birds</p>
      </div>
      <button class="button is-danger" @click="deleteChecklist(checklist.id)">Delete</button>
    </div>
  </div>
  [[pass]]
</div>



[[block page_scripts]]
<!-- Loads the mychecklist-specific js for Vue -->
<script>
  let checklists = Json.parse('[[=checklists]]');
  let delete_checklist_url = "[[=URL('delete_checklist')]]";
</script>
<script src="js/my_checklist.js"></script>

<!--
<script>
  let my_callback_url = "[[=XML(my_callback_url)]]";
</script>
<script src="js/index.js"></script>
-->
[[end]]
